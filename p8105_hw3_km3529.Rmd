---
title: "p8105_hw3_km3529"
author: Karina Myers
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
knitr::opts_chunk$set(
	fig.width = 6, 
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```



## Problem 1 
```{r}
data("instacart")
```
This dataset contains `r nrow(instacart)` rows and `r ncol(instacart)` columns. 

Observations are the level of items in orders by user. There are user and order variables such as user ID, order ID, order day, and order hour. There are also item variables such as product name, aisle, department, whether the item has been ordered before, and some numeric codes. 


How many aisles are there, and which aisles are the most items ordered from?
```{r}
instacart %>% 
  count(aisle) %>% 
  arrange(desc(n))
```


Make a plot that shows the number of items ordered in each aisle, limiting this to aisles with more than 10000 items ordered. Arrange aisles sensibly, and organize your plot so others can read it.

note: cat var will be ordered numerically --> change to factor 

```{r}
instacart %>% 
  count(aisle) %>% 
  filter(n > 10000) %>% 
  mutate(
    aisle = factor(aisle), 
    aisle = fct_reorder(aisle, n)
  ) %>% 
  ggplot(aes(x = aisle, y = n)) + 
  geom_point() + 
  	theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```


Make a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. Include the number of times each item is ordered in your table.

```{r}
instacart %>% 
	filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  filter(rank < 4 ) %>% 
  arrange(aisle, rank) %>% 
knitr::kable()
```



Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table).
```{r}
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow, 
    values_from = mean_hour
  )
  
```





## Problem 2
Accelerometers have become an appealing alternative to self-report techniques for studying physical activity in observational studies and clinical trials, largely because of their relative objectivity. 

During observation periods, the devices measure “activity counts” in a short period; one-minute intervals are common. Because accelerometers can be worn comfortably and unobtrusively, they produce around-the-clock observations.

This problem uses five weeks of accelerometer data collected on a 63 year-old male with BMI 25, who was admitted to the Advanced Cardiac Care Center of Columbia University Medical Center and diagnosed with congestive heart failure (CHF). The data can be downloaded here. In this spreadsheet, variables activity.* are the activity counts for each minute of a 24-hour day starting at midnight.


Notes: 
  - 5 weeks of data 
  - activity_ : activity counts for each minute of a 24 hour day 
  
Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

load + tidy 
useful names 
weekday and weekend variable --> add variable (weekend v week day) 
Encode data with reasonable variable classes. --> might not make sense now but will make sense as work on later problems 
  - are activity counts going to be number? 
  - min going to be num? 
  - day of week going to be char or factor? if factor, in order that is reasonable? 


```{r}
accel_df = 
  read_csv("./Data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
      activity_1:activity_1440, 
      names_to = "minute",
      names_prefix = "activity_", 
      values_to = "activity_count") %>% 
  mutate(
    day_type = case_when(
        day %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday") ~ "weekday", 
        day %in% c("Saturday", "Sunday") ~ "weekend", 
        TRUE ~ "") , 
    activity_count = as.numeric(activity_count), 
    day = as.factor(day), 
    minute = as.numeric(minute), 
    day = forcats::fct_relevel(
        day, c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
    )

#just to check day_type var
accel_df %>% 
  distinct(day_type, )
```

SUMMARY HERE 








